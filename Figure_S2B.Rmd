---
title: "Figure_S2B"
author: "Mike O'Donnell"
date: "4/29/2019"
output: html_document
---


```{r dataload}
#### for 30% octanol ####
SOS_30pct <- readr::read_csv(here::here("extdata","Figure_S2B_30pct.csv")) %>%
  dplyr::filter(response.time < 20,
                date != "2019_04_29") %>%
  group_by(date, genotype, food, cond, cue) %>%
  tidyr::nest() %>% 
  mutate(plateID = factor(1:nrow(.))) %>%
  tidyr::unnest()
  

SOS_30pct %>%
  mutate(food = fct_relevel(food, c("OP50", "JUb39"))) %>%
  dplyr::filter(
  #                     response.time < 20,
  #                     genotype %in% c("tdc-1", "N2"),
                      # food %in% c("OP50", "JUb39")
                      ) %>%
  #                     date %in% c("2019_03_18", "2019_04_09", "2019_04_13", "2019_04_29")) %>%
  ggplot(aes(x = genotype, y = response.time)) +
  #geom_boxplot(outlier.shape =NA) +
  #geom_point(pch = 21) +#, position = position_jitterdodge()) +
  ggbeeswarm::geom_quasirandom(aes(colour = food), width = 0.2) +
  scale_color_plot("grey-blue", drop = TRUE) +
  facet_grid(.~food) +
  add.median('response.time', colour = "red") +
  add.quartiles('response.time') +
  theme_my +
  add.n(genotype) +
  labs(x = "food",
       y = "time to reversal (s)")


SOS_30pct %>% 
  dplyr::filter(food != "JUb39; tdcDel::cmR delAADC", date != "2019_04_29") %>% 
  lme4::lmer(data = ., response.time ~ genotype * food + (1|plateID) + (1|date)) %>%
  emmeans(pairwise ~ genotype| food)
```
